<div class="row fade-in-1-sec" #mainContentDiv>
  <div class="card col s12 z-depth-0 transparent" *ngIf="artist"   (contextmenu)="artistMenu.onContextMenu($event, artist)">
    <div class="card-image" #artistbannerdiv (window:resize)="0" [ngStyle]="{'min-height.px': (artistbannerdiv.offsetWidth / 2), 'max-height.px': (artistbannerdiv.offsetWidth / 2) }">
      <div class="artist-banner" [ngStyle]="{'min-height.px': (artistbannerdiv.offsetWidth / 2), 'max-height.px': (artistbannerdiv.offsetWidth / 2) }">
        <img src="{{mediaPath}}/images/artists/{{artist?.artistId}}/Banner.jpg" onError="this.src='assets/images/defaults/banner.png'" [ngStyle]="{'min-width.px': artistbannerdiv.offsetWidth }">
        <!-- Use the div below to apply opacity or color masks to the artist banner image -->
        <div class="artist-banner-mask" style="width: 100%; height: 100%; position: absolute; top: 0px; left: 0px;"></div>
        <span class="card-title black fade-in-half-sec" id="large-card-title">
          <h1 class="fade-in-1-sec" style="display: inline; vertical-align: middle;">{{artist?.artistName}}</h1>
          <button mz-button class="detailed-follow-btn btn-medium waves-effect"
                  *ngIf="!isFollowing()" (click)="changeFollowStatus(true)">
          FOLLOW
          </button>
          <button mz-button class="detailed-follow-btn btn-medium waves-effect"
                  *ngIf="isFollowing()" (click)="changeFollowStatus(false)">
          UNFOLLOW
          </button>
        </span>
        <a (click)="playArtistSongs(0, artist?.songs)" class="btn-floating halfway-fab waves-effect waves-light hoverable blue-bt" *ngIf="artist?.songs?.length > 0">
          <i class="material-icons">play_arrow</i>
        </a>
      </div>
    </div>
  </div>
  <ng-container *ngIf="artist">
    <mz-tab [fixedTabWidth]="'true'" [responsiveThreshold]="'true'">
      <mz-tab-item class="fade-in-half-sec" [label]="'Overview'" [active]="true">
        <div class="row fade-in-half-sec" style="margin-top: 30px;" *ngIf="artist?.songs || artist?.albums">
          <h2 class="center">Popular Songs</h2>
        </div>
        <div class="row fade-in-1-sec" *ngIf="artist?.songs">
          <table class="bordered responsive-table white-text" *ngIf="artist?.songs?.length > 0">
            <thead>
              <tr>
                <th></th>
                <th>Title</th>
                <th>Album</th>
                <th class="center">Plays</th>
              </tr>
            </thead>
            <tbody class="tracklist" *ngIf="artist?.songs">
              <tr *ngFor="let song of artist?.songs?.slice(0, 10); let i = index" (dblclick)="playArtistSongs(i, artist?.songs)"
                  (contextmenu)="songMenu.onContextMenu($event, song)">
                <td class="song-number">
                  <a class="song-number-value" >{{i+1}}.</a>
                  <a (click)="playbackSong($event,song)" class="song-playback-icon"  *ngIf="!song.isPlaying">
                    <i class="material-icons" style=" font-size: 1.9rem; vertical-align: middle">play_circle_outline</i>
                  </a>
                  <a (click)="playbackSong($event,song)" class="song-playback-icon" *ngIf="song.isPlaying">
                    <i class="material-icons" style=" font-size: 1.9rem; vertical-align: middle">pause</i>
                  </a>
                </td>
                <td>{{song?.title}}</td>
                <td *ngIf="song">
                  <a [routerLink]="['../../album', song?.albumId]"  (contextmenu)="albumMenu.onContextMenu($event, { albumId: song?.albumId, followed: false } )">{{song?.albumTitle}}</a>
                </td>
                <td class="center">{{song?.playCount}}</td>
              </tr>
            </tbody>
          </table>
          <div class="col s12 fade-in-half-sec" style="margin-bottom: 20px;" *ngIf="artist?.songs?.length == 0 && artist?.albums?.length > 0">
            <div class="card-panel large transparent z-depth-0 center">
              <h3 class="grey-text">No songs by this artist</h3>
            </div>
          </div>
        </div>
        <div class="row fade-in-2-sec valign-wrapper" style="min-height: 250px;" *ngIf="!artist?.songs && artist?.albums">
          <div class="loader">Loading...</div>
        </div>

        <div class="row fade-in-half-sec" style="margin-top: 60px;" *ngIf="artist?.songs || artist?.albums">
          <h2 class="center">Albums</h2>
        </div>
        <div class="row fade-in-half-sec" *ngIf="artist?.albums?.length > 0">
          <div class="col s12 m3 fade-in-1-sec" *ngFor="let album of showAllAlbums ? artist?.albums : artist?.albums?.slice(0, (artist?.albums?.length > 12 ? 11 : 12))">
            <div class="card transparent hoverable">
              <div class="card-image" *ngIf="album" #albumCardDiv (window:resize)="0" [ngStyle]="{'min-height.px': albumCardDiv.offsetWidth, 'max-height.px': albumCardDiv.offsetWidth }">
                <div class="album-div valign-wrapper" [ngStyle]="{'min-height.px': albumCardDiv.offsetWidth, 'max-height.px': albumCardDiv.offsetWidth }">
                  <a [routerLink]="['../../album', album?.albumId]">
                    <img class="album-img" src="{{mediaPath}}/images/album_arts/{{album?.albumId}}/Album.jpg" onError="this.src='assets/images/defaults/album.svg'" [ngStyle]="{'min-width.px': albumCardDiv.offsetWidth }">
                  </a>
                  <span class="card-title black" id="small-card-title">
                    <h4 class="truncate" *ngIf="album">
                      <a [routerLink]="['../../album', album?.albumId]">{{album?.albumTitle}}</a>
                    </h4>
                    <h5 class="truncate">{{album?.releaseYear?.substring(0,4)}}</h5>
                  </span>
                  <a (click)="playAlbumSongs(album?.albumId)" class="btn-floating halfway-fab waves-effect waves-light blue-bt" *ngIf="artist && artist.songs">
                    <i class="material-icons">play_arrow</i>
                  </a>
                </div>
              </div>
            </div>
          </div>
          <div class="col s12 m3 fade-in-1-sec" *ngIf="artist?.albums?.length > 12 && !showAllAlbums">
            <div class="card transparent hoverable">
              <div class="card-image" #moreAlbumsDiv (window:resize)="0" [ngStyle]="{'min-height.px': moreAlbumsDiv.offsetWidth, 'max-height.px': moreAlbumsDiv.offsetWidth }">
                <div class="valign-wrapper grey darken-3" [ngStyle]="{'min-height.px': moreAlbumsDiv.offsetWidth, 'max-height.px': moreAlbumsDiv.offsetWidth }">
                  <a (click)="showAllAlbums = true">
                    <div class="btn transparent more-albums" #moreAlbumsBtn style="padding: 0px;" (window:resize)="0" [ngStyle]="{'min-height.px': moreAlbumsDiv.offsetWidth, 'max-height.px': moreAlbumsDiv.offsetWidth }">
                      <div class="col s12 m4" style="padding: 0px;" *ngFor="let album of artist?.albums?.slice(12, (artist?.albums?.length > 21 ? 20 : 21))">
                        <div class="card transparent" style="margin: 0px;">
                          <div class="card-image" *ngIf="album" #albumCardDiv (window:resize)="0" [ngStyle]="{'min-height.px': albumCardDiv.offsetWidth, 'max-height.px': albumCardDiv.offsetWidth }">
                            <div class="album-div valign-wrapper" [ngStyle]="{'min-height.px': albumCardDiv.offsetWidth, 'max-height.px': albumCardDiv.offsetWidth }">
                                <img class="album-img" src="assets/images/album_arts/{{album?.albumId}}/Album.jpg" onError="this.src='assets/images/defaults/album.svg'" [ngStyle]="{'min-width.px': albumCardDiv.offsetWidth }"> <!--{{mediaPath}} -->
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col s12 m4 grey darken-3" style="padding: 0px;" *ngIf="artist?.albums?.length > 21 && artist?.events">
                        <div class="card-image" #nMoreDiv (window:resize)="0" [ngStyle]="{'min-height.px': nMoreDiv.offsetWidth, 'max-height.px': nMoreDiv.offsetWidth }">
                          <div class="valign-wrapper" [ngStyle]="{'min-height.px': nMoreDiv.offsetWidth, 'max-height.px': nMoreDiv.offsetWidth }">
                              <div class="col s12 grey-text" style="text-align: center;">+{{artist?.albums?.length - 20}}</div>
                          </div>
                        </div>
                      </div>
                      <div class="more-albums-label valign-wrapper" style="position: absolute; width: 100%;" [ngStyle]="{'min-height.px': moreAlbumsDiv.offsetWidth, 'max-height.px': moreAlbumsDiv.offsetWidth }">
                        <h2 class="col s12" style="text-align: center;">Show all</h2>
                      </div>
                    </div>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col s12 fade-in-half-sec" style="margin-bottom: 40px;" *ngIf="artist?.songs?.length > 0 && artist?.albums?.length == 0">
          <div class="card-panel large transparent z-depth-0 center">
            <h3 class="grey-text">No albums by this artist</h3>
          </div>
        </div>
        <div class="row fade-in-2-sec valign-wrapper" style="min-height: 250px;" *ngIf="!artist?.albums">
          <div class="loader">Loading...</div>
        </div>

        <div class="row fade-in-2-sec" *ngIf="artist?.songs?.length == 0 && artist?.albums?.length == 0">
          <div class="col s12">
            <div class="card-panel large transparent z-depth-0 center">
              <h2 class="grey-text">No songs or albums by this artist</h2>
            </div>
          </div>
          <div class="col s12">
            <div class="card-panel large transparent z-depth-0">
              <div class="row" (window:resize)="0" [ngStyle]="{'min-height.px': (mainContentDiv.offsetWidth / 4)}"></div>
            </div>
          </div>
        </div>
      </mz-tab-item>
      <mz-tab-item [label]="'About'" class="fade-in-half-sec">
        <div *ngIf="artist" (window:resize)="0" [ngStyle]="{'min-height.px': (mainContentDiv.offsetWidth / 4)}">
          <h3 style="margin-top: 30px;">
            <p>{{artist?.bio}}</p>
          </h3>
        </div>
        <div class="row fade-in-2-sec valign-wrapper" style="min-height: 250px;" *ngIf="!artist">
          <div class="loader">Loading...</div>
        </div>
      </mz-tab-item>

      <mz-tab-item [label]="'Related Artists'" class="fade-in-half-sec">
        <div (window:resize)="0" [ngStyle]="{'min-height.px': (mainContentDiv.offsetWidth / 4)}">
          <h2 class="center" style="margin-top: 30px;">Related Artists</h2>
          <ul class="collection" style="margin-top: 20px; border:none;">
            <li class="collection-item avatar grey darken-4" *ngFor="let thing of things">
              <img src="assets/images/kebin.jpg" alt="" class="circle">
              <span class="title white-text">Kevin Parker</span>
              <p class="white-text">16 Followers
                <br>
              </p>
              <a href="#!" class="secondary-content">
                <a class="waves-effect waves-light btn">Follow</a>
              </a>
            </li>
          </ul>
        </div>
      </mz-tab-item>

      <mz-tab-item [label]="'Events'" class="fade-in-half-sec">
        <div (window:resize)="0" [ngStyle]="{'min-height.px': (mainContentDiv.offsetWidth / 4)}">
          <div class="row fade-in-half-sec" *ngIf="artist?.events">
            <h2 class="center" style="margin-top: 30px;">Events</h2>
            <ul class="collection" style="margin-top: 20px; border:none;" *ngIf="artist?.events?.length > 0">
              <li class="collection-item grey darken-4" *ngFor="let event of artist?.events">
                <div class="row" style="margin-bottom: 0px;">
                <div class="col m1">
                  <div style="width: 50px;" *ngIf="event?.eventDate">
                    <div style="height: 20px; background-color: red;"><h4 class="white-text center" style="padding-top: 2px;">{{monthNames[(+event?.eventDate?.toString().substring(5,7))-1]}}</h4></div>
                    <div style="height: 30px; background-color: white;"><h3 class="black-text center" style="padding-top: 5px;"><b>{{(event?.eventDate?.toString().substring(8,10))}}</b></h3></div>
                  </div>
                </div>
                <div class="col m8">
                  <div class="row">
                    <div class="col m5">
                      <h4>{{event?.eventTitle}}</h4>
                    </div>
                    <div class="col m7" *ngIf="event?.address">
                        <i class="material-icons white-text">location_on</i>
                        <span (click)="navigateToMaps(event?.address)" style="font-size: 16px; font-weight: 500; color: #ccc; cursor: pointer;">{{event?.address?.addressLine1}}, {{event?.address?.city}} {{event?.address?.state}}</span>
                    </div>
                  </div>
                </div>
                <div class="col m3">
                  <a class="right waves-effect waves-light btn blue-bt">Get Tickets</a>
                </div>
                </div>
              </li>
            </ul>
          </div>
          <div class="col s12 fade-in-half-sec" style="margin-bottom: 40px;" *ngIf="artist?.events?.length == 0">
            <div class="card-panel large transparent z-depth-0 center">
              <h3 class="grey-text">No upcoming events</h3>
            </div>
          </div>
          <div class="row fade-in-2-sec valign-wrapper" style="min-height: 250px;" *ngIf="!artist?.events">
            <div class="loader">Loading...</div>
          </div>
        </div>
      </mz-tab-item>
    </mz-tab>


  </ng-container>

  <!-- Loading animation -->
  <div class="row fade-in-2-sec valign-wrapper" style="min-height: 250px;" *ngIf="!artist">
    <div class="loader">Loading...</div>
  </div>
</div>

<app-song-menu #songMenu [songs]="artist?.songs" ></app-song-menu>
<app-artist-menu #artistMenu [artists]="artist" [library]="false"></app-artist-menu>
<app-album-menu #albumMenu> </app-album-menu>
